# 🛣 ScriptRefine 项目阶段推进规划

> 建议按阶段推进，每一阶段都可以形成一个相对稳定的版本。

## 第一阶段：稳定内测版（当前阶段的完善）

- **功能验证**
  - 使用真实会议语料（不同长度、不同说话人、不同 ASR 来源）跑完整流程。
  - 重点检查：内容是否有缺失、是否有错段、讲话人结构是否正确。
- **日志与调试**
  - 利用当前日志功能（`logging.enabled=true`），观察每个分片的：
    - 原始文本
    - 提示词
    - LLM 输出
  - 根据日志优化 `max_tokens`、`overlap`、`chunking` 策略。
- **提示词优化**
  - 根据实际效果，微调 `prompts/rewrite.txt` 和 `prompts/summary.txt`：
    - 进一步强调「**不得遗漏内容，不得虚构**」。
    - 针对你常见的会议类型（教育行政 / 教研 / 学术等）增加示例。
- **配置梳理**
  - 使用 `config_local.yaml` 管理本地环境配置（API Key、本地模型选择等）。
  - 确认仓库中的 `config.yaml` 不包含任何敏感信息。

✅ 目标：在你自己的机器 + 小范围试用中，能稳定输出完整、可信的语稿和纪要。

---

## 第二阶段：生产可用版（单机部署）

- **测试体系**
  - 使用 pytest 编写核心模块测试：
    - `TextCleaner`：各种语料下不误删、不误合并。
    - `TextChunker`：长文本、无分段、纯中文、多讲话人场景。
    - `TextRewriter._merge_chunks`：验证跨分片无内容缺失。
  - 使用几份典型会议录音转写文本做集成测试，固定版本回归。
- **错误处理 & 体验**
  - Web 前端增加更友好的错误提示（LLM 调用失败、超时、配置错误等）。
  - 对 LLM 调用增加超时和重试机制，避免单次调用卡死。
- **性能与长文本**
  - 使用 1–3 万字的长文本测试处理时间和内存占用。
  - 根据实际模型（本地 / 在线）能力调整：
    - `llm.max_tokens`
    - `text_processing.chunking.max_tokens`
    - `overlap` 与 `min_chunk_size`
- **部署方案（单机）**
  - 编写 `Dockerfile`，封装：
    - Python 依赖
    - Web 服务（Flask）
  - 使用 `docker-compose`（可选）启动：
    - ScriptRefine Web 服务
    - 本地 LLM（如 Ollama）或只使用在线 LLM。

✅ 目标：在一台服务器上稳定长期运行，少量用户并发使用无明显问题。

---

## 第三阶段：团队级生产版（多用户 / 多场景）

- **权限与安全**
  - 为 Web UI 增加简单的登录 / 鉴权机制（例如：
    - 反向代理 + Basic Auth，或
    - 简单的账号密码机制）。
  - 按部门或场景管理配置（不同模型、不同提示词）。
- **多用户体验**
  - 增加「任务列表」页面：
    - 显示当前和历史任务（文件名、时间、状态、结果链接）。
  - 增加「对照视图」：
    - 左侧原文，右侧整理结果，支持高亮差异。
- **监控与运维**
  - 日志轮转（logrotate 或 Python logging 的 TimedRotatingFileHandler）。
  - 关键指标监控（可导出到 Prometheus / Grafana 等）：
    - 请求数、失败率、平均处理时长。
  - 健康检查 `/api/health` 接入运维系统。

✅ 目标：可供一个小团队日常使用，出现问题时易于定位和恢复。

---

## 第四阶段：高级功能与生态扩展

- **功能增强**
  - 多语种支持（英文 / 中英文混合）。
  - 可配置模板：
    - 不同会议类型对应不同纪要结构和写作风格。
  - 增加「重点提取」模块：
    - 自动提取决策、行动项、风险点等。
- **集成能力**
  - 提供 HTTP API 文档（OpenAPI/Swagger），便于与其他系统集成。
  - 支持从对象存储（如 OSS / S3）读取和写入文档。
- **前端体验升级**
  - 可以考虑迁移到更现代的前端框架（如 React/Vue + Tailwind），但这是加分项，不是必须。

✅ 目标：从「工具」升级为「平台」，便于其它系统或业务流程接入。


